<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Introduction of CNN | SHINYUU BLOG</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-108690246-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Introduction of CNN</h1><a id="logo" href="/.">SHINYUU BLOG</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Introduction of CNN</h1><div class="post-meta">Oct 28, 2017</div><div class="post-content"><p>This paper briefly introduces the Convolution Neural Network (CNN) and its implementation on Python, mainly focused on explaining the basic concepts and the structure of the classic LeNet. Convolution Neural Network refers to the neural network consisting of convolutional. A CNN consists of an input and an output layer, as well as multiple hidden layers. The hidden layers are either convolutional, pooling or fully connected. They are often applied to analyzing visual imagery.</p>
<h2 id="Convolutional"><a href="#Convolutional" class="headerlink" title="Convolutional"></a>Convolutional</h2><p>Convolutional layers apply a convolution operation to the input, passing the result to the next layer.Every time we sample a window of the same size as the weight, let the elements and weights in the window multiply one by one and then add them. Just as shown in the gif below.<br><img src="http://dataunion.org/wp-content/uploads/2015/03/6.gif" alt="Source:dataunion"><br>The following figure shows the convolution process to  calculate the 2 × 2 result with a 4 × 4 matrix input, using a 3 × 3 matrix as weight. Usually we call this weight the kernel or filter.<br><img src="https://raw.githubusercontent.com/vdumoulin/conv_arithmetic/master/gif/no_padding_no_strides.gif" alt="Source:vdumoulin@github"><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##implement the convolutional</span></div><div class="line"><span class="keyword">from</span> mxnet <span class="keyword">import</span> nd</div><div class="line"></div><div class="line">w = nd.arange(<span class="number">9</span>).reshape((<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>)) <span class="comment"># batch,channel,height,width</span></div><div class="line">b = nd.array([<span class="number">1</span>])</div><div class="line">data = nd.arange(<span class="number">16</span>).reshape((<span class="number">1</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">4</span>))</div><div class="line">out = nd.Convolution(data, w, b, kernel=w.shape[<span class="number">2</span>:], num_filter=w.shape[<span class="number">1</span>])</div><div class="line"></div><div class="line">print(<span class="string">'input:'</span>, data, <span class="string">'\n\nweight:'</span>, w, <span class="string">'\n\nbias:'</span>, b, <span class="string">'\n\noutput:'</span>, out)</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##Outcome</span></div><div class="line"> input: </div><div class="line">[[[[  <span class="number">0.</span>   <span class="number">1.</span>   <span class="number">2.</span>   <span class="number">3.</span>]</div><div class="line">   [  <span class="number">4.</span>   <span class="number">5.</span>   <span class="number">6.</span>   <span class="number">7.</span>]</div><div class="line">   [  <span class="number">8.</span>   <span class="number">9.</span>  <span class="number">10.</span>  <span class="number">11.</span>]</div><div class="line">   [ <span class="number">12.</span>  <span class="number">13.</span>  <span class="number">14.</span>  <span class="number">15.</span>]]]]</div><div class="line">&lt;NDArray <span class="number">1</span>x1x4x4 @cpu(<span class="number">0</span>)&gt; </div><div class="line"></div><div class="line">weight: </div><div class="line">[[[[ <span class="number">0.</span>  <span class="number">1.</span>  <span class="number">2.</span>]</div><div class="line">   [ <span class="number">3.</span>  <span class="number">4.</span>  <span class="number">5.</span>]</div><div class="line">   [ <span class="number">6.</span>  <span class="number">7.</span>  <span class="number">8.</span>]]]]</div><div class="line">&lt;NDArray <span class="number">1</span>x1x3x3 @cpu(<span class="number">0</span>)&gt; </div><div class="line"></div><div class="line">bias: </div><div class="line">[ <span class="number">1.</span>]</div><div class="line">&lt;NDArray <span class="number">1</span> @cpu(<span class="number">0</span>)&gt; </div><div class="line"></div><div class="line">output: </div><div class="line">[[[[ <span class="number">259.</span>  <span class="number">295.</span>]</div><div class="line">   [ <span class="number">403.</span>  <span class="number">439.</span>]]]]</div><div class="line">&lt;NDArray <span class="number">1</span>x1x2x2 @cpu(<span class="number">0</span>)&gt;</div><div class="line"><span class="comment"># Eg：259= 0*0+4*3+8*6+1*1+5*4+9*7+2*2+6*5+10*8+1, look at weight  and input again to see how to get the output</span></div></pre></td></tr></table></figure>
<p>We can control how to move the window, and how to fill the window at the edge, by setting the stride &amp; pad. The following figure shows the convolution process to calculate the 3 × 3 result with a 5 × 5 matrix input, using a 3 × 3 matrix as weight. Here stride is 2 and pad is 1.<br><img src="https://raw.githubusercontent.com/vdumoulin/conv_arithmetic/master/gif/padding_strides.gif" alt="Source:vdumoulin@github"><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##implement the convolutional with stride is 2 and pad is 1</span></div><div class="line">w = nd.arange(<span class="number">9</span>).reshape((<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>)) </div><div class="line">b = nd.array([<span class="number">1</span>])</div><div class="line">data = nd.arange(<span class="number">25</span>).reshape((<span class="number">1</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>))</div><div class="line">out = nd.Convolution(data, w, b, kernel=w.shape[<span class="number">2</span>:], num_filter=w.shape[<span class="number">1</span>],stride=(<span class="number">2</span>,<span class="number">2</span>), pad=(<span class="number">1</span>,<span class="number">1</span>))</div><div class="line">print(<span class="string">'input:'</span>, data, <span class="string">'\n\nweight:'</span>, w, <span class="string">'\n\nbias:'</span>, b, <span class="string">'\n\noutput:'</span>, out)</div></pre></td></tr></table></figure></p>
<h2 id="Pooling"><a href="#Pooling" class="headerlink" title="Pooling"></a>Pooling</h2><p>Because the convolution layer acts on a window each time, it is sensitive to the position. The pooling layer is a good way to alleviate this problem. Pooling layers combine the outputs of neuron clusters at one layer into a single neuron in the next layer. For example, max pooling uses the maximum value from each of a cluster of neurons at the prior layer. In practice, we often select the largest number or the average number as the output.<br><img src="http://oyer09cam.bkt.clouddn.com/blog/171101/EEi5lCCIGC.jpg?imageslim" alt="Max Pooling"><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##implement the pooling</span></div><div class="line">data = nd.arange(<span class="number">18</span>).reshape((<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>)) <span class="comment"># two channel</span></div><div class="line"></div><div class="line">max_pool = nd.Pooling(data=data, pool_type=<span class="string">"max"</span>, kernel=(<span class="number">2</span>,<span class="number">2</span>))</div><div class="line">avg_pool = nd.Pooling(data=data, pool_type=<span class="string">"avg"</span>, kernel=(<span class="number">2</span>,<span class="number">2</span>))</div><div class="line"></div><div class="line">print(<span class="string">'data:'</span>, data, <span class="string">'\n\nmax pooling:'</span>, max_pool, <span class="string">'\n\navg pooling:'</span>, avg_pool)</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##Outcome</span></div><div class="line">data: </div><div class="line">[[[[  <span class="number">0.</span>   <span class="number">1.</span>   <span class="number">2.</span>]</div><div class="line">   [  <span class="number">3.</span>   <span class="number">4.</span>   <span class="number">5.</span>]</div><div class="line">   [  <span class="number">6.</span>   <span class="number">7.</span>   <span class="number">8.</span>]]</div><div class="line"></div><div class="line">  [[  <span class="number">9.</span>  <span class="number">10.</span>  <span class="number">11.</span>]</div><div class="line">   [ <span class="number">12.</span>  <span class="number">13.</span>  <span class="number">14.</span>]</div><div class="line">   [ <span class="number">15.</span>  <span class="number">16.</span>  <span class="number">17.</span>]]]]</div><div class="line">&lt;NDArray <span class="number">1</span>x2x3x3 @cpu(<span class="number">0</span>)&gt; </div><div class="line"></div><div class="line">max pooling: </div><div class="line">[[[[  <span class="number">4.</span>   <span class="number">5.</span>]</div><div class="line">   [  <span class="number">7.</span>   <span class="number">8.</span>]]</div><div class="line"></div><div class="line">  [[ <span class="number">13.</span>  <span class="number">14.</span>]</div><div class="line">   [ <span class="number">16.</span>  <span class="number">17.</span>]]]]</div><div class="line">&lt;NDArray <span class="number">1</span>x2x2x2 @cpu(<span class="number">0</span>)&gt; </div><div class="line"></div><div class="line">avg pooling: </div><div class="line">[[[[  <span class="number">2.</span>   <span class="number">3.</span>]</div><div class="line">   [  <span class="number">5.</span>   <span class="number">6.</span>]]</div><div class="line"></div><div class="line">  [[ <span class="number">11.</span>  <span class="number">12.</span>]</div><div class="line">   [ <span class="number">14.</span>  <span class="number">15.</span>]]]]</div><div class="line">&lt;NDArray <span class="number">1</span>x2x2x2 @cpu(<span class="number">0</span>)&gt;</div></pre></td></tr></table></figure>
<h2 id="Structure"><a href="#Structure" class="headerlink" title="Structure"></a>Structure</h2><p>Do you remember the words “the hidden layers are either convolutional, pooling or fully connected” in the previous text? The following figure shows the architecture of classic LeNet-5. Talk about CNN, we alawys say LeNet-5 which from this paper <a href="http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf" target="_blank" rel="external">http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf</a>.<br><img src="http://oyer09cam.bkt.clouddn.com/blog/171101/f4BLe1aae9.jpg?imageslim" alt="the architecture of   LeNet "><br>In fact, many CNN structures are similar, look at this one below (DeepID) and compare with LeNet, you would find the common convolutional and pooling layers. Similar to ImageNet, DeepID network is a CNN to learn the characteristics of the face, developed by Hong Yi from the Hong Kong Chinese University.<br><img src="http://oyer09cam.bkt.clouddn.com/blog/171101/JKHf21jghm.jpg?imageslim" alt="the architecture of DeepID "><br>After knowing these, now we can try to write a simple CNN by ourselves, how excited. Before the formal writing of the program, we also want to introduce the circumstances of the input data and output data have multiple channels. Run the following code and compare the results.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##input data has 2 channels</span></div><div class="line"><span class="comment">##sum after each channel is convoluted</span></div><div class="line">w = nd.arange(<span class="number">8</span>).reshape((<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>))</div><div class="line">data = nd.arange(<span class="number">18</span>).reshape((<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>))</div><div class="line"></div><div class="line">out = nd.Convolution(data, w, b, kernel=w.shape[<span class="number">2</span>:], num_filter=w.shape[<span class="number">0</span>])</div><div class="line"></div><div class="line">print(<span class="string">'input:'</span>, data, <span class="string">'\n\nweight:'</span>, w, <span class="string">'\n\nbias:'</span>, b, <span class="string">'\n\noutput:'</span>, out)</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##output &amp; input data has 2 channels</span></div><div class="line"><span class="comment">##convolution on each channel</span></div><div class="line">w = nd.arange(<span class="number">16</span>).reshape((<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>))</div><div class="line">data = nd.arange(<span class="number">18</span>).reshape((<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>))</div><div class="line">b = nd.array([<span class="number">1</span>,<span class="number">2</span>])</div><div class="line"></div><div class="line">out = nd.Convolution(data, w, b, kernel=w.shape[<span class="number">2</span>:], num_filter=w.shape[<span class="number">0</span>])</div><div class="line"></div><div class="line">print(<span class="string">'input:'</span>, data, <span class="string">'\n\nweight:'</span>, w, <span class="string">'\n\nbias:'</span>, b, <span class="string">'\n\noutput:'</span>, out)</div></pre></td></tr></table></figure>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>The data set includes pictures of 10 different categories of clothes. Using the CNN model, just on Epoch 0 (only train one epoch), the Train accuracy can reach 0.795923 with Test accuracy 0.822015. Continue to train several epoches, you can find the accuracy rate will increase a lot more.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##implement a simple CNN using Gluon</span></div><div class="line"><span class="keyword">from</span> mxnet <span class="keyword">import</span> gluon</div><div class="line"><span class="keyword">from</span> mxnet.gluon <span class="keyword">import</span> nn</div><div class="line"><span class="keyword">from</span> mxnet <span class="keyword">import</span> ndarray <span class="keyword">as</span> nd</div><div class="line"><span class="keyword">from</span> mxnet <span class="keyword">import</span> autograd</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data_fashion_mnist</span><span class="params">(batch_size)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform_mnist</span><span class="params">(data, label)</span>:</span></div><div class="line">        <span class="keyword">return</span> nd.transpose(data.astype(<span class="string">'float32'</span>), (<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>))/<span class="number">255</span>, label.astype(<span class="string">'float32'</span>)</div><div class="line">    mnist_train = gluon.data.vision.FashionMNIST(train=<span class="keyword">True</span>, transform=transform_mnist)[:]</div><div class="line">    mnist_test = gluon.data.vision.FashionMNIST(train=<span class="keyword">False</span>, transform=transform_mnist)[:]</div><div class="line">    train_data = DataLoader(mnist_train[<span class="number">0</span>], nd.array(mnist_train[<span class="number">1</span>]), batch_size, shuffle=<span class="keyword">True</span>)</div><div class="line">    test_data = DataLoader(mnist_test[<span class="number">0</span>], nd.array(mnist_test[<span class="number">1</span>]), batch_size, shuffle=<span class="keyword">False</span>)</div><div class="line">    <span class="keyword">return</span> (train_data, test_data)</div><div class="line"></div><div class="line">batch_size = <span class="number">256</span></div><div class="line">train_data, test_data = load_data_fashion_mnist(batch_size)</div><div class="line"></div><div class="line">net = nn.Sequential()</div><div class="line"><span class="keyword">with</span> net.name_scope():</div><div class="line">    net.add(</div><div class="line">        nn.Conv2D(channels=<span class="number">20</span>, kernel_size=<span class="number">5</span>, activation=<span class="string">'relu'</span>),</div><div class="line">        nn.MaxPool2D(pool_size=<span class="number">2</span>, strides=<span class="number">2</span>),</div><div class="line">        nn.Conv2D(channels=<span class="number">40</span>, kernel_size=<span class="number">3</span>, activation=<span class="string">'relu'</span>),</div><div class="line">        nn.MaxPool2D(pool_size=<span class="number">2</span>, strides=<span class="number">2</span>),</div><div class="line">        nn.Flatten(),</div><div class="line">        nn.Dense(<span class="number">128</span>, activation=<span class="string">"relu"</span>),</div><div class="line">        nn.Dense(<span class="number">10</span>)</div><div class="line">    )</div><div class="line">net.initialize()</div><div class="line"></div><div class="line">loss = gluon.loss.SoftmaxCrossEntropyLoss()</div><div class="line">trainer = gluon.Trainer(net.collect_params(),</div><div class="line">                        <span class="string">'sgd'</span>, &#123;<span class="string">'learning_rate'</span>: <span class="number">0.5</span>&#125;)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">accuracy</span><span class="params">(output, label)</span>:</span></div><div class="line">    <span class="keyword">return</span> nd.mean(output.argmax(axis=<span class="number">1</span>)==label).asscalar()   </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate_accuracy</span><span class="params">(data_iterator, net)</span>:</span></div><div class="line">    acc = <span class="number">0.</span></div><div class="line">    <span class="keyword">for</span> data, label <span class="keyword">in</span> data_iterator:</div><div class="line">        output = net(data)</div><div class="line">        acc += accuracy(output, label)</div><div class="line">    <span class="keyword">return</span> acc / len(data_iterator)</div><div class="line"></div><div class="line"></div><div class="line">num_epochs=<span class="number">5</span>                    </div><div class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> range(num_epochs):</div><div class="line">    train_loss = <span class="number">0.</span></div><div class="line">    train_acc = <span class="number">0.</span></div><div class="line">    <span class="keyword">for</span> data, label <span class="keyword">in</span> train_data:</div><div class="line">        <span class="keyword">with</span> autograd.record():</div><div class="line">            output = net(data)</div><div class="line">            L = loss(output, label)</div><div class="line">        L.backward()</div><div class="line"></div><div class="line">        trainer.step(batch_size)</div><div class="line"></div><div class="line">        train_loss += nd.mean(L).asscalar()</div><div class="line">        train_acc += accuracy(output, label)</div><div class="line"></div><div class="line">    test_acc = evaluate_accuracy(test_data, net)</div><div class="line">    print(<span class="string">"Epoch %d. Loss: %f, Train acc %f, Test acc %f"</span> % (</div><div class="line">            epoch, train_loss/n, train_acc/n, test_acc))</div></pre></td></tr></table></figure></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>[1]: <em>Mu Li</em>. Gluon-tutorials-zh.<br>[2]: <em>Yann Lecun,etc</em>. Gradient-Based Learning Appied to Document Recognition.<br>[3]: <em>wikipedia</em>. wikipedia.org/wiki/Convolutional_neural_network.</p>
</div><div class="tags"><a href="/tags/Python/">Python</a><a href="/tags/NeuralNetwork/">NeuralNetwork</a></div><div class="post-nav"><a href="/MLP/" class="next">Multilayer Perceptron</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://yoursite.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/NeuralNetwork/" style="font-size: 15px;">NeuralNetwork</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/CNN/">Introduction of CNN</a></li><li class="post-list-item"><a class="post-list-link" href="/MLP/">Multilayer Perceptron</a></li><li class="post-list-item"><a class="post-list-link" href="/PythonBasicstutorial/">Python Basics Tutorial</a></li><li class="post-list-item"><a class="post-list-link" href="/Start/">Start</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://sites.google.com/view/lixinyuhomepage" title="Homepage" target="_blank">Homepage</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">SHINYUU BLOG.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>