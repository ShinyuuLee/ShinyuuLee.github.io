<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Advanced CNN AlexNet &amp; VGG | SHINYUU BLOG</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script><!-- hexo-inject:begin --><!-- hexo-inject:end -->(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-108690246-1','auto');ga('send','pageview');</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Advanced CNN AlexNet &amp; VGG</h1><a id="logo" href="/.">SHINYUU BLOG</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Advanced CNN AlexNet &amp; VGG</h1><div class="post-meta">Nov 5, 2017</div><div class="post-content"><p>In the previous article we had a preliminary understanding of CNN, now we are going to elaborate the two more complex network models named AlexNet and VGG, developed after LeNet. AlexNet competed in the ImageNet Large Scale Visual Recognition Challenge (ILSVRC) in 2012, and won the championship by achieving a top-5 error of 15.3%, designed by the SuperVision group, consisting of Alex Krizhevsky, Geoffrey Hinton, and Ilya Sutskever. VGG competed in ILSVRC-2014, and secured the first and the second places in the localisation and classification tasks respectively, designed by Visual Geometry Group at Oxford University, see <a href="http://www.robots.ox.ac.uk/~vgg/research/very_deep/" target="_blank" rel="external">here</a> for more information.</p>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><p>In order to maintain coherence, here we still continue to write programs based on the dataset in the previous article. When we load the dataset, we will take an extra step to expand the data to 224 × 224 to fit AlexNet and VGG better.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##load dataset with an extra step</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data_fashion_mnist</span><span class="params">(batch_size, resize=None)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform_mnist</span><span class="params">(data, label)</span>:</span></div><div class="line">        <span class="keyword">if</span> resize:</div><div class="line">            n = data.shape[<span class="number">0</span>]</div><div class="line">            new_data = nd.zeros((n, resize, resize, data.shape[<span class="number">3</span>]))</div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">               new_data[i] = image.imresize(data[i], resize, resize)</div><div class="line">            data = new_data</div><div class="line">        <span class="keyword">return</span> nd.transpose(data.astype(<span class="string">'float32'</span>), (<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>))/<span class="number">255</span>, label.astype(<span class="string">'float32'</span>)</div><div class="line">    mnist_train = gluon.data.vision.FashionMNIST(train=<span class="keyword">True</span>, transform=transform_mnist)[:]</div><div class="line">    mnist_test = gluon.data.vision.FashionMNIST(train=<span class="keyword">False</span>, transform=transform_mnist)[:]</div><div class="line">    train_data = DataLoader(mnist_train[<span class="number">0</span>], nd.array(mnist_train[<span class="number">1</span>]), batch_size, shuffle=<span class="keyword">True</span>)</div><div class="line">    test_data = DataLoader(mnist_test[<span class="number">0</span>], nd.array(mnist_test[<span class="number">1</span>]), batch_size, shuffle=<span class="keyword">False</span>)</div><div class="line">    <span class="keyword">return</span> (train_data, test_data)</div><div class="line"></div><div class="line">train_data, test_data = load_data_fashion_mnist(batch_size=<span class="number">64</span>, resize=<span class="number">224</span>)</div></pre></td></tr></table></figure></p>
<p>We just need to redefine net function in the CNN code , with the rest same as previous ones. Our code made some corresponding changes according to the dataset, such as clothing 10 categories determines our output dimension is 10. The main purpose of this essay is to help readers understand the core ideas of these networks. </p>
<h2 id="AlexNet"><a href="#AlexNet" class="headerlink" title="AlexNet"></a>AlexNet</h2><p>Compared to LeNet, AlexNet has 8 layers, including 5 convolutionals and 2 fully connected hidden layers, as well as an output layer. The numbers of channel in the convolutional layers are also get larger. Due to the limitations of early GPU memory, the earliest AlexNet included a dual-stream design that allowed half of the nodes in the network to fit into one GPU. Fortunately, GPU has made great strides in the past few years, except some special structure, we no longer need such a special design. We can learn more about AlexNet by reading this published article in <a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf." target="_blank" rel="external">here</a>.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##AlexNet Architecture</span></div><div class="line"><span class="keyword">from</span> mxnet.gluon <span class="keyword">import</span> nn</div><div class="line"></div><div class="line">net = nn.Sequential()</div><div class="line"><span class="keyword">with</span> net.name_scope():</div><div class="line">    net.add(</div><div class="line">        <span class="comment"># first block</span></div><div class="line">        nn.Conv2D(channels=<span class="number">96</span>, kernel_size=<span class="number">11</span>,strides=<span class="number">4</span>, activation=<span class="string">'relu'</span>),</div><div class="line">        nn.MaxPool2D(pool_size=<span class="number">3</span>, strides=<span class="number">2</span>),</div><div class="line">        <span class="comment"># second block</span></div><div class="line">        nn.Conv2D(channels=<span class="number">256</span>, kernel_size=<span class="number">5</span>,padding=<span class="number">2</span>, activation=<span class="string">'relu'</span>),</div><div class="line">        nn.MaxPool2D(pool_size=<span class="number">3</span>, strides=<span class="number">2</span>),</div><div class="line">        <span class="comment"># third block </span></div><div class="line">        nn.Conv2D(channels=<span class="number">384</span>, kernel_size=<span class="number">3</span>,padding=<span class="number">1</span>, activation=<span class="string">'relu'</span>),</div><div class="line">        nn.Conv2D(channels=<span class="number">384</span>, kernel_size=<span class="number">3</span>,padding=<span class="number">1</span>, activation=<span class="string">'relu'</span>),</div><div class="line">        nn.Conv2D(channels=<span class="number">256</span>, kernel_size=<span class="number">3</span>,padding=<span class="number">1</span>, activation=<span class="string">'relu'</span>),</div><div class="line">        nn.MaxPool2D(pool_size=<span class="number">3</span>, strides=<span class="number">2</span>),</div><div class="line">        <span class="comment"># fourth block </span></div><div class="line">        nn.Flatten(),</div><div class="line">        nn.Dense(<span class="number">4096</span>, activation=<span class="string">"relu"</span>),</div><div class="line">        nn.Dropout(<span class="number">.5</span>),</div><div class="line">        <span class="comment"># fifth block</span></div><div class="line">        nn.Dense(<span class="number">4096</span>, activation=<span class="string">"relu"</span>),</div><div class="line">        nn.Dropout(<span class="number">.5</span>),</div><div class="line">        <span class="comment"># sixth block</span></div><div class="line">        nn.Dense(<span class="number">10</span>)</div><div class="line">    )</div></pre></td></tr></table></figure></p>
<h2 id="VGG"><a href="#VGG" class="headerlink" title="VGG"></a>VGG</h2><p>If the network structure has a large number of repeating structures, then we can build these networks more compactly. The first deep network that uses this structure is VGG, and of course VGG is more modular compared to AlexNet.</p>
<p>Each block in VGG uses 3 × 3 kernels without changing. Here we introduce the simplest VGG 11 with 8 convolutions and 3 fully connected layers, and after this you can easily write more complex VGG networks. See <a href="https://arxiv.org/pdf/1409.1556.pdf" target="_blank" rel="external">here</a> and the following picture, you cloud see details of different kinds of VGG.<br><img src="http://oyer09cam.bkt.clouddn.com/blog/171105/jLg4elL7e3.jpg?imageslim" alt=""><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##VGG basic Architecture block</span></div><div class="line"><span class="keyword">from</span> mxnet.gluon <span class="keyword">import</span> nn</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vgg_block</span><span class="params">(num_conv, channels)</span>:</span></div><div class="line">    <span class="comment">#num_conv is the number of convolutional</span></div><div class="line">    <span class="comment">#channels is the channel of convolutional</span></div><div class="line">    out = nn.Sequential()</div><div class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(num_conv):</div><div class="line">        out.add(</div><div class="line">            nn.Conv2D(channels=channels, kernel_size=<span class="number">3</span>,</div><div class="line">                      padding=<span class="number">1</span>, activation=<span class="string">'relu'</span>)</div><div class="line">        )</div><div class="line">    out.add(nn.MaxPool2D(pool_size=<span class="number">2</span>, strides=<span class="number">2</span>))</div><div class="line">    <span class="keyword">return</span> out</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vgg_stack</span><span class="params">(architecture)</span>:</span></div><div class="line">    out = nn.Sequential()</div><div class="line">    <span class="keyword">for</span> (num_conv, channels) <span class="keyword">in</span> architecture:</div><div class="line">        out.add(vgg_block(num_conv, channels))</div><div class="line">    <span class="keyword">return</span> out</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##VGG 11 Architecture</span></div><div class="line">num_outputs = <span class="number">10</span></div><div class="line">architecture = ((<span class="number">1</span>,<span class="number">64</span>), (<span class="number">1</span>,<span class="number">128</span>), (<span class="number">2</span>,<span class="number">256</span>), (<span class="number">2</span>,<span class="number">512</span>), (<span class="number">2</span>,<span class="number">512</span>))</div><div class="line">net = nn.Sequential()</div><div class="line"><span class="keyword">with</span> net.name_scope():</div><div class="line">    net.add(</div><div class="line">        vgg_stack(architecture),</div><div class="line">        nn.Flatten(),</div><div class="line">        nn.Dense(<span class="number">4096</span>, activation=<span class="string">"relu"</span>),</div><div class="line">        nn.Dropout(<span class="number">.5</span>),</div><div class="line">        nn.Dense(<span class="number">4096</span>, activation=<span class="string">"relu"</span>),</div><div class="line">        nn.Dropout(<span class="number">.5</span>),</div><div class="line">        nn.Dense(num_outputs))</div></pre></td></tr></table></figure>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>[1]: <em>Mu Li</em>. Gluon-tutorials-zh.<br>[2]: <em>Alex Krizhevsky,etc</em>. ImageNet Classification with Deep Convolutional Neural Networks.<br>[3]: <em>Karen Simonyan, Andrew Zisserman</em>. Very Deep Convolutional Networks for Large-scale Image Recogniton.</p>
</div><div class="tags"><a href="/tags/Python/">Python</a><a href="/tags/NeuralNetwork/">NeuralNetwork</a></div><div class="post-nav"><a href="/GooglenetResnet/" class="pre">Advanced CNN GoogLeNet, ResNet &amp; DenseNet</a><a href="/CNN/" class="next">Introduction of CNN</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://yoursite.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/NeuralNetwork/" style="font-size: 15px;">NeuralNetwork</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/StyleTransfer/">Style Transfer</a></li><li class="post-list-item"><a class="post-list-link" href="/Linux/">Linux Basic Operation</a></li><li class="post-list-item"><a class="post-list-link" href="/TrickCNN/">Tricks for CNN Coding</a></li><li class="post-list-item"><a class="post-list-link" href="/GooglenetResnet/">Advanced CNN GoogLeNet, ResNet & DenseNet</a></li><li class="post-list-item"><a class="post-list-link" href="/AlexnetVgg/">Advanced CNN AlexNet & VGG</a></li><li class="post-list-item"><a class="post-list-link" href="/CNN/">Introduction of CNN</a></li><li class="post-list-item"><a class="post-list-link" href="/MLP/">Multilayer Perceptron</a></li><li class="post-list-item"><a class="post-list-link" href="/PythonBasicstutorial/">Python Basics Tutorial</a></li><li class="post-list-item"><a class="post-list-link" href="/Start/">Start</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://sites.google.com/view/lixinyuhomepage" title="Homepage" target="_blank">Homepage</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">SHINYUU BLOG.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>